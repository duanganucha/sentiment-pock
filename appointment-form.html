<!DOCTYPE html>
<html lang="th">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#4F46E5',
                        secondary: '#10B981',
                    }
                }
            }
        }
    </script>
</head>

<body
    class="bg-gradient-to-r from-blue-100 to-green-100 min-h-screen w-full flex items-center justify-center overflow-auto p-4">

    <div class="w-full max-w-md bg-white p-8 rounded-2xl shadow-xl mx-auto">
        <h2 class="text-3xl font-bold text-center text-primary mb-8">
            üìÖ ‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢
        </h2>

        <form id="appointmentForm" class="space-y-6">
            <div>
                <label for="name" class="block text-gray-700 font-semibold">üë§ ‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•:</label>
                <input type="text" id="name" name="name" required
                    class="w-full mt-1 px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary">
            </div>

            <div>
                <label for="idCard" class="block text-gray-700 font-semibold">üÜî ‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô:</label>
                <input type="text" id="idCard" name="idCard" maxlength="13" required
                    class="w-full mt-1 px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"
                    pattern="\d{13}" title="‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô 13 ‡∏´‡∏•‡∏±‡∏Å">
            </div>

            <div>
                <label for="phone" class="block text-gray-700 font-semibold">üìû ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå:</label>
                <div class="flex">
                    <input type="tel" id="phone" name="phone" required
                        class="w-full mt-1 px-4 py-3 border border-gray-300 rounded-l-lg focus:outline-none focus:ring-2 focus:ring-primary">
                    <button type="button" id="getPhoneBtn"
                        class="mt-1 px-4 py-3 bg-secondary text-white font-bold rounded-r-lg hover:bg-green-600 transition-all">
                        üì≤ ‡∏î‡∏∂‡∏á‡πÄ‡∏ö‡∏≠‡∏£‡πå
                    </button>
                </div>
            </div>

            <div>
                <label for="date" class="block text-gray-700 font-semibold">üìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢:</label>
                <input type="date" id="date" name="date" required
                    class="w-full mt-1 px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary">
            </div>

            <div>
                <label for="time" class="block text-gray-700 font-semibold">‚è∞ ‡πÄ‡∏ß‡∏•‡∏≤‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢:</label>
                <input type="time" id="time" name="time" required
                    class="w-full mt-1 px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary">
            </div>

            <div>
                <label for="reason" class="block text-gray-700 font-semibold">ü©∫ ‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏• / ‡∏≠‡∏≤‡∏Å‡∏≤‡∏£:</label>
                <input type="text" id="reason" name="reason" required
                    class="w-full mt-1 px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary">
            </div>

            <button type="submit"
                class="w-full bg-primary text-white font-bold py-3 rounded-lg hover:bg-indigo-600 transition-all">
                ‚úÖ ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢
            </button>
        </form>
    </div>

    <script>
        function getPhoneNumber() {
            if ('contacts' in navigator && 'select' in navigator.contacts) {
                navigator.contacts.select(['tel'], { multiple: false })
                    .then(function (contacts) {
                        if (contacts.length > 0 && contacts[0].tel.length > 0) {
                            $('#phone').val(contacts[0].tel[0]);
                        } else {
                            showAlert('error', '‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå');
                        }
                    })
                    .catch(function (err) {
                        console.error('Error: ', err);
                        showAlert('error', '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏∂‡∏á‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå');
                    });
            } else {
                showAlert('error', '‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏î‡∏∂‡∏á‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥');
            }
        }

        $('#getPhoneBtn').click(getPhoneNumber);

        function showAlert(type, message) {
            const title = type === 'success' ? '‚úÖ ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!' : '‚ùå ‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î!';
            const icon = type === 'success' ? 'success' : 'error';
            Swal.fire({
                title: title,
                text: message,
                icon: icon,
                confirmButtonText: '‡∏ï‡∏Å‡∏•‡∏á',
                confirmButtonColor: '#4F46E5'
            });
        }

        $('#appointmentForm').submit(function (e) {
            e.preventDefault();
            const formData = new FormData(this);
            const appointmentData = Object.fromEntries(formData.entries());

            fetch('https://script.google.com/macros/s/AKfycbw8LA8g166b_G0qou3mAqO2iT0qcuTANPPGNrzCojH6k4cD9g0g6VLsYTen9zDrmK7-/exec', {
                method: 'POST',
                mode: 'no-cors',
                body: JSON.stringify({
                    action: 'processForm',
                    formData: new URLSearchParams(formData).toString()
                }),
                headers: {
                    'Content-Type': 'application/json',
                }
            })
                .then(response => {
                    if (response.type === 'opaque') {
                        showAlert('success', 'üéâ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ñ‡∏π‡∏Å‡∏™‡πà‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß');
                        $('#appointmentForm')[0].reset();
                    } else {
                        throw new Error('Network response was not ok.');
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    showAlert('error', 'üòì ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á');
                });
        });
    </script>
</body>

</html>
